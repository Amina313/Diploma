# Diploma

## –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞
–ü—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –≤—ã —É—Å—Ç—Ä–æ–∏–ª–∏—Å—å –º–ª–∞–¥—à–∏–º —Å–ø–µ—Ü–∏–∞–ª–∏—Å—Ç–æ–º –ø–æ –º–∞—à–∏–Ω–Ω–æ–º—É –æ–±—É—á–µ–Ω–∏—é –∏–ª–∏, –∫–∞–∫ –ø—Ä–∏–Ω—è—Ç–æ –≥–æ–≤–æ—Ä–∏—Ç—å, ¬´–¥–∂—É–Ω–æ–º¬ª, –≤ –∫–æ–º–ø–∞–Ω–∏—é, –∫–æ—Ç–æ—Ä–∞—è –∑–∞–Ω–∏–º–∞–µ—Ç—Å—è —Å–æ–∑–¥–∞–Ω–∏–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ç–µ–ª—å–Ω—ã—Ö —Å–∏—Å—Ç–µ–º. –í –±–ª–∏–∂–∞–π—à–∏–µ 3-4 –Ω–µ–¥–µ–ª–∏ –≤–∞—Å –∂–¥—ë—Ç –∑–Ω–∞–∫–æ–º—Å—Ç–≤–æ —Å –∫–æ–º–∞–Ω–¥–æ–π, –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∏ –∑–∞—â–∏—Ç–∞ –±–æ–ª—å—à–æ–≥–æ –ø—Ä–æ–µ–∫—Ç–∞, –∞ —Ç–∞–∫–∂–µ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –º–µ–ª–∫–∏—Ö –ø–æ—Ä—É—á–µ–Ω–∏–π –æ—Ç —Ä–∞–∑–Ω—ã—Ö —á–ª–µ–Ω–æ–≤ –∫–æ–º–∞–Ω–¥—ã.

## –ó–∞–¥–∞—á–∞  –ø—Ä–æ–µ–∫—Ç–∞ 
**–ë–∏–∑–Ω–µ—Å-–∑–∞–¥–∞—á–∞**: –ù—É–∂–Ω–æ –ø–æ–º–æ—á—å –Ω–∞—à–µ–º—É –∫–ª–∏–µ–Ω—Ç—É –ø–æ–≤—ã—Å–∏—Ç—å –ø—Ä–∏–±—ã–ª—å –æ—Ç –¥–æ–ø—Ä–æ–¥–∞–∂ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–µ, —Ü–µ–ª–∏–º—Å—è –≤ 20 %.

## üìå –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞ –∏ –º–æ–¥–µ–ª–∏

üìã –í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–∞–Ω–æ –Ω–∞ —Ç—Ä–µ—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–∞—Ö –¥–∞–Ω–Ω—ã—Ö:

Dataset Events (events.csv) ‚Äî –∂—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-–º–∞–≥–∞–∑–∏–Ω–æ–º:
Timestamp: –≤—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è.
VisitorID: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
Event: —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è (–ø—Ä–æ—Å–º–æ—Ç—Ä—ã, –ø–æ–∫—É–ø–∫–∏ –∏ —Ç.–¥.).
ItemID: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞.
TransactionID: –Ω–æ–º–µ—Ä —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ (–µ—Å–ª–∏ —Å–æ–±—ã—Ç–∏–µ —Å–≤—è–∑–∞–Ω–æ —Å –ø–æ–∫—É–ø–∫–æ–π).
Dataset Category Tree (category_tree.csv) ‚Äî –¥—Ä–µ–≤–æ–≤–∏–¥–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π —Ç–æ–≤–∞—Ä–æ–≤:
CategoryID: —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
ParentID: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏.
Dataset Item Properties (item_properties.csv) ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Å–≤–æ–π—Å—Ç–≤–∞ —Ç–æ–≤–∞—Ä–æ–≤:
Timestamp: –¥–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–≤–æ–π—Å—Ç–≤–∞.
ItemID: –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Ç–æ–≤–∞—Ä–∞.
Property: –Ω–∞–∑–≤–∞–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞.
Value: –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞.

üîç –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö

–í—Å–µ –¥–∞–Ω–Ω—ã–µ –±—ã–ª–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã. –ë—ã–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏:

–û–±—Ä–∞–±–æ—Ç–∫–∞ –¥—É–±–ª–∏—Ä—É—é—â–∏—Ö—Å—è –∑–∞–ø–∏—Å–µ–π: –ø–æ–≤—Ç–æ—Ä—è—é—â–∏–µ—Å—è —Å—Ç—Ä–æ–∫–∏ –±—ã–ª–∏ —É–¥–∞–ª–µ–Ω—ã –∏–∑ –≤—Å–µ—Ö –¥–∞—Ç–∞—Å–µ—Ç–æ–≤.
–£–¥–∞–ª–µ–Ω–∏–µ –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π: –ø–æ–ª—è —Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –±—ã–ª–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω—ã –Ω—É–ª–µ–≤—ã–º –∑–Ω–∞—á–µ–Ω–∏–µ–º.
–¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–π —à–∫–∞–ª—ã: —Å—Ç–æ–ª–±–µ—Ü Timestamp –±—ã–ª –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –≤ —É–¥–æ–±–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç datetime.
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ—Ä–µ–ø—Ä–µ–∑–µ–Ω—Ç–∞—Ç–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö: –∏—Å–∫–ª—é—á–µ–Ω—ã –º–∞–ª–æ–∞–∫—Ç–∏–≤–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –Ω–µ–ø–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã.

üìâ –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è
–ù–∞ –æ—Å–Ω–æ–≤–∞–Ω–∏–∏ —É–∫–∞–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö –±—ã–ª–∏ –ø–æ—Å—Ç—Ä–æ–µ–Ω—ã –¥–≤–µ –∫–ª—é—á–µ–≤—ã–µ —Ç–∞–±–ª–∏—Ü—ã:

–ú–∞—Ç—Ä–∏—Ü–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π (user_item_matrix) ‚Äî –∫–∞–∂–¥–∞—è —è—á–µ–π–∫–∞ –æ—Ç—Ä–∞–∂–∞–µ—Ç –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–º —Ç–æ–≤–∞—Ä–æ–º.
–§–∞–∫—Ç–æ—Ä—ã –∞–π—Ç–µ–º-—é–∑–µ—Ä (user_item_factors) ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å —Ç–æ–≤–∞—Ä–∞–º–∏ (—á–∞—Å—Ç–æ—Ç–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–π, –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–∫—É–ø–æ–∫ –∏ —Ç.–¥.)
–≠—Ç–∏ —Ç–∞–±–ª–∏—Ü—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å –¥–∞–ª–µ–µ –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –º–æ–¥–µ–ª–µ–π.

üîÑ –í–∞–ª–∏–¥–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—É—á–µ–Ω–∏—è –∏ –ø—Ä–æ–≤–µ—Ä–∫–∏
–ë—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω —Å—Ç—Ä–æ–≥–∏–π –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Å–ø–ª–∏—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ —Å–º–µ—à–∏–≤–∞–Ω–∏—è. –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ—Ö–æ–¥–∏–ª —Å–ª–µ–¥—É—é—â–∏–º –æ–±—Ä–∞–∑–æ–º:

Train (60%): –ø–µ—Ä–∏–æ–¥ –æ–±—É—á–µ–Ω–∏—è.
Validation (20%): –∫–æ–Ω—Ç—Ä–æ–ª—å–Ω–∞—è –≥—Ä—É–ø–ø–∞ –¥–ª—è –≤—ã–±–æ—Ä–∞ –ª—É—á—à–µ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –º–æ–¥–µ–ª–∏.
Test (20%): –Ω–µ–∑–∞–≤–∏—Å–∏–º–∞—è –≤—ã–±–æ—Ä–∫–∞ –¥–ª—è —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

üî¨ –ü—Ä–æ–≤–µ–¥—ë–Ω–Ω—ã–µ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã
–ë—ã–ª–∏ –ø—Ä–æ–≤–µ–¥–µ–Ω—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ã —Å –¥–≤—É–º—è –æ—Å–Ω–æ–≤–Ω—ã–º–∏ –º–µ—Ç–æ–¥–∞–º–∏:

–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (LightFM):
–ü—Ä–∏–º–µ–Ω—è–ª–∞—Å—å –≥–∏–±—Ä–∏–¥–Ω–∞—è –º–æ–¥–µ–ª—å —Ñ–∞–∫—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (—É—á—ë—Ç –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–µ–Ω–∏–π, —Ç–∞–∫ –∏ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ —Ç–æ–≤–∞—Ä–æ–≤).
–ì–∏–ø–µ—Ä–ø–∞—Ä–∞–º–µ—Ç—Ä loss='warp' –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª—Å—è –¥–ª—è –º–∞–∫—Å–∏–º–∏–∑–∞—Ü–∏–∏ –∫–∞—á–µ—Å—Ç–≤–∞ —Ä–∞–Ω–∂–∏—Ä—É–µ–º—ã—Ö —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π.
–ò—Ç–æ–≥–æ–≤–∞—è –º–µ—Ç—Ä–∏–∫–∞ –∫–∞—á–µ—Å—Ç–≤–∞ ‚Äî Precision@3 (—Ç–æ—á–Ω–æ—Å—Ç—å –ø–æ –ø–µ—Ä–≤—ã–º —Ç—Ä–µ–º —Ç–æ–≤–∞—Ä–∞–º).
–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost):
–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π –ø–æ–¥—Ö–æ–¥ –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–æ–∫—É–ø–æ–∫ —Ç–æ–≤–∞—Ä–æ–≤ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏.
–ë–∞–∑–æ–≤–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è XGBoost –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –¥–ª—è –ø—Ä–æ–≥–Ω–æ–∑–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω—ã—Ö –ø–æ–∫—É–ø–æ–∫.
–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∫–∞—á–µ—Å—Ç–≤–∞: Accuracy, F1-Score, Recall, Precision.

üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–æ–≤
–ö–æ–ª–ª–∞–±–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è (LightFM):

–°—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ Precision@3: 0.4187
–ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π –±—É—Å—Ç–∏–Ω–≥ (XGBoost):

Classification Report:
              precision    recall  f1-score   support

           0       0.97      0.99      0.98       704
           1       0.00      0.00      0.00        16
           2       0.12      0.12      0.12         8
           3       0.50      0.38      0.43        13
           4       0.00      0.00      0.00         4
           5       0.00      0.00      0.00         1
           6       0.00      0.00      0.00         2
          12       0.00      0.00      0.00         1

    accuracy                           0.94       749
   macro avg       0.20      0.19      0.19       749
weighted avg       0.92      0.94      0.93       749

üöÄ Docker-–æ–±—Ä–∞–∑ –∏ –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
–û–±—Ä–∞–∑ Docker —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:

docker build -t xgboost_flask_app .
–ó–∞—Ç–µ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–æ–π:

docker run --rm -it -p 5000:5000 xgboost_flask_app

üí¨ –û–±—â–µ–Ω–∏–µ —Å —Å–µ—Ä–≤–∏—Å–æ–º —á–µ—Ä–µ–∑ API

–°–µ—Ä–≤–µ—Ä –¥–æ—Å—Ç—É–ø–µ–Ω –ø–æ –∞–¥—Ä–µ—Å—É http://127.0.0.1:5000. –î–æ—Å—Ç—É–ø–Ω—ã —Å–ª–µ–¥—É—é—â–∏–µ —Ç–æ—á–∫–∏:

POST /predict: –ü–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ —Ç–æ–≤–∞—Ä–æ–≤ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.
GET /metrics: –ü–æ–ª—É—á–∏—Ç—å —Ç–µ–∫—É—â–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏.

## –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
* –ë–∞–∑–æ–≤—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: Pandas
* –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏: SciPy, NumPy
* –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è: Matplotlib, Seaborn
* –ë–∏–±–∏–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è: Scikit-learn (sklearn), XGBoost (eXtreme Gradient Boosting)

### [C—Å—ã–ª–∫–∞ –Ω–∞ –î–∏–ø–ª–æ–º–Ω—É—é —Ä–∞–±–æ—Ç—É. Jupyter-–Ω–æ—É—Ç–±—É–∫](https://github.com/Amina313/Diploma/blob/main/ml_copy.ipynb)
### [C—Å—ã–ª–∫–∞ –Ω–∞ –î–∏–ø–ª–æ–º–Ω—É—é —Ä–∞–±–æ—Ç—É. –ü–æ–ª–Ω–∞—è –≤–µ—Ä—Å–∏—è py](https://github.com/Amina313/Diploma/blob/main/ml_py.py)
